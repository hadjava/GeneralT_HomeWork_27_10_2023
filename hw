-- Homework 27.10.2023

/*
 1 уровень сложности: Задача в этой дз, одна, остальные разобрали на уроке, но задача интересная.
Найти сотрудников(вывести информацию о них - имя, фамилию), 
у которых наибольшая зарплата в их конкретном департаменте

*/

use hr;
SELECT *
from employees;

/* 
   С прошлого урока
SELECT
 first_name as name,
 last_name as surname,
 salary
 FROM employees
 WHERE salary < (
   SELECT
   AVG(salary) as average_salary
   FROM employees);
 */
 
SELECT
  t1.first_name,
  t1.last_name,
  t1.department_id,
  t1.salary
FROM employees t1
WHERE (t1.department_id, t1.salary) IN (
  SELECT department_id, MAX(salary)
  FROM employees
  GROUP BY department_id
);
/*
В этом запросе:

1. Мы выбираем сотрудников из таблицы "employees" (t1).
2. Мы используем подзапрос, который группирует сотрудников по department_id 
и находит максимальную зарплату в каждом департаменте с помощью функции MAX().
3. После этого мы сверяем каждого сотрудника (t1) с результатами подзапроса, используя условие 
(t1.department_id, t1.salary) IN (подзапрос), чтобы найти сотрудников с наивысшей зарплатой 
в каждом департаменте.
4.Мы выводим информацию о таких сотрудниках, включая их имя, фамилию, 
идентификатор департамента и зарплату.
Этот запрос выведет информацию о сотрудниках, у которых наивысшая зарплата 
в каждом департаменте, с использованием оператора GROUP BY.

*/
